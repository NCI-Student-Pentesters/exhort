import React from 'react';
import { Vulnerability } from '../api/report';
import { SYNK_SIGNUP_URL, issueLink } from '../utils/utils';
import { usePrivateIssueHelper } from '../hooks/usePrivateDataHelper';
interface VulnerabilityLinkProps {
  providerName: 'snyk' | 'oss-index';
  vulnerability: Vulnerability;
}

export const VulnerabilityLink: React.FC<VulnerabilityLinkProps> = ({
  providerName,
  vulnerability,
}) => {
  const privateIssueHelper = usePrivateIssueHelper();
  return (
    <>
      {privateIssueHelper.hideIssue(providerName, vulnerability.unique) ? (
        <>
          <a href={SYNK_SIGNUP_URL} target="_blank" rel="noreferrer">
            Sign up for a Snyk account
          </a>{' '}
          to learn about the vulnerabilities found
        </>
      ) : (
        <a href={issueLink(providerName, vulnerability.id)} target="_blank" rel="noreferrer">
          {vulnerability.id}
        </a>
      )}
    </>
  );
};
